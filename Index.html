<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kalkulator Angsuran KSG</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 30px;
  display: flex;
  justify-content: center;
}

.container {
  background: white;
  width: 480px;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,.1);
}

h1 {
  text-align: center;
  margin-bottom: 4px;
}

h2 {
  text-align: center;
  font-size: 14px;
  font-weight: normal;
  color: #555;
  margin-bottom: 20px;
}

label {
  font-weight: bold;
  margin-top: 12px;
  display: block;
}

input, select {
  width: 100%;
  padding: 9px;
  margin-top: 5px;
  font-size: 14px;
}

select {
  font-size: 16px;
  font-weight: bold;
}

button {
  margin-top: 20px;
  width: 100%;
  padding: 12px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 5px;
  font-size: 16px;
  cursor: pointer;
}

.result {
  margin-top: 20px;
  background: #f9f9f9;
  padding: 15px;
  border-radius: 8px;
}

.row {
  display: flex;
  justify-content: space-between;
  margin: 6px 0;
}

.row strong {
  font-weight: bold;
}

.warning {
  color: red;
  font-weight: bold;
}

footer {
  margin-top: 25px;
  text-align: center;
  font-size: 12px;
  color: #777;
}
</style>
</head>

<body>

<div class="container">

  <h1>Kalkulator Angsuran KSG</h1>
  <h2>Bank Sumsel Babel Cabang Muara Enim</h2>

  <label>Jumlah Plafond</label>
  <input type="text" id="plafond" oninput="formatInput(this)">

  <label>Jangka Waktu (Bulan)</label>
  <input type="number" id="tenor">

  <label>Gaji Pegawai</label>
  <input type="text" id="gaji" oninput="formatInput(this)">

  <label>Sisa Pinjaman Lama (Top Up)</label>
  <input type="text" id="sisaLama" value="0" oninput="formatInput(this)">

  <label>Tambahan Penghasilan</label>
  <select id="tambahan">
    <option value="tidak">Tidak</option>
    <option value="ya">Ya</option>
  </select>

  <button onclick="hitung()">Hitung Angsuran</button>

  <div class="result" id="hasil" style="display:none;">

    <div class="row"><span>Angsuran / Bulan</span><strong>Rp <span id="angsuran"></span></strong></div>
    <div class="row"><span>Sisa Gaji</span><strong>Rp <span id="sisaGaji"></span></strong></div>
    <div class="row"><span>Persentase Angsuran</span><strong><span id="persen"></span>%</strong></div>

    <hr>

    <div class="row"><span>Biaya Administrasi</span><span>Rp <span id="admin"></span></span></div>
    <div class="row"><span>Asuransi</span><span>Rp <span id="asuransi"></span></span></div>
    <div class="row"><span>Tabungan Beku</span><span>Rp <span id="tabungan"></span></span></div>
    <div class="row"><span>Sisa Pinjaman Lama</span><span>Rp <span id="lama"></span></span></div>

    <hr>

    <div class="row"><strong>Hasil Bersih Diterima</strong><strong>Rp <span id="bersih"></span></strong></div>

    <p id="peringatan" class="warning"></p>
  </div>

  <footer>
    © 2026 M Ari Sandy - Admin Kredit
  </footer>

</div>


<script>
function bersihkan(v) {
  return Number(v.replace(/\./g, ""));
}

function formatInput(el) {
  let v = el.value.replace(/\D/g, "");
  el.value = v.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

function rupiah(n) {
  return n.toLocaleString("id-ID");
}

function hitung() {
  const plafondVal = bersihkan(document.getElementById("plafond").value);
  const tenorVal = Number(document.getElementById("tenor").value);
  const gajiVal = bersihkan(document.getElementById("gaji").value);
  const sisaPinjaman = bersihkan(document.getElementById("sisaLama").value);
  const tambahan = document.getElementById("tambahan").value;

  if (!plafondVal || !tenorVal || !gajiVal) {
    alert("Data belum lengkap");
    return;
  }

  // === PMT (sesuai Excel) ===
  const rate = 0.095 / 12;
  const angsuranVal = Math.abs(
    (rate * plafondVal) / (1 - Math.pow(1 + rate, -tenorVal))
  );

  // === Biaya ===
  const adminVal = plafondVal * 0.01;
  const tahun = Math.ceil(tenorVal / 12);
  const asuransiVal = plafondVal * 3.8 / g1000 * tahun;
  const tabunganVal = angsuranVal;

  // === Hasil ===
  const bersihVal = plafondVal - adminVal - asuransiVal - tabunganVal - sisaPinjaman;
  const sisaGajiVal = gajiVal - angsuranVal;

  const persenVal = (angsuranVal / gajiVal) * 100;
  const batas = tambahan === "ya" ? 95 : 90;

  // === Tampilkan Output ===
  document.getElementById("angsuran").innerText = rupiah(Math.round(angsuranVal));
  document.getElementById("admin").innerText = rupiah(Math.round(adminVal));
  document.getElementById("asuransi").innerText = rupiah(Math.round(asuransiVal));
  document.getElementById("tabungan").innerText = rupiah(Math.round(tabunganVal));
  document.getElementById("lama").innerText = rupiah(Math.round(sisaPinjaman));
  document.getElementById("bersih").innerText = rupiah(Math.round(bersihVal));
  document.getElementById("sisaGaji").innerText = rupiah(Math.round(sisaGajiVal));
  document.getElementById("persen").innerText = persenVal.toFixed(2);

  const peringatan = document.getElementById("peringatan");
  peringatan.innerText =
    persenVal > batas
      ? `⚠ Angsuran melebihi batas ${batas}% dari gaji`
      : "";

  document.getElementById("hasil").style.display = "block";
}
</script>


</body>
</html>
